image: docker/compose:1.25.4

options:
  docker: true

pipelines:
  default:
    - step:
        script:
          - ci/dependencies.sh
          - docker-compose run -T client /usr/local/src/test.sh
          - docker-compose down
          - docker-compose build app test-runner 
          - docker-compose up test-runner
        services:
          - docker